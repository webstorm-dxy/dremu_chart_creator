# 文件目录及分类规则

- components

	一个组件一个文件夹，文件夹名为组件名。

	子组件在父组件文件夹中。

  组件间尽量实现 `低耦合，高内聚`。

	例：

	- parent-component

    - child-component

	      - parent-component.scss (可选)
	  - parent-component.d.ts
	  - parent-component.tsx
	
- images

  仅程序内部可用的图像资源。

  暂无目录结构规定。

- interfaces

  scripts 等的申明文件，只允许定义接口、类型，不允许拥有功能，实例化代码。

  按所申明的文件的功能归类。

- json

  仅程序内部可用的json文件。

- pages

  参见 `next.js` 文档。

- public

  公开的静态资源文件。

- scripts

  非组件脚本与非申明文件。

  按功能用途分类。

  - utils

    工具类脚本。

- styles

  页面或全局的样式文件，禁止包含组件样式文件。

- 其它

  配置等文件。

---

# 代码规范

## 通用

### 类型

- 禁止使用 `any` 。（除非是库的类型为any并且需要引用，此时可以关闭 [@typescript-eslint/no-explicit-any](https://typescript-eslint.io/rules/no-explicit-any) 规则）。

### 类型及接口（申明文件）

- 必须在申明文件定义，禁止在非 `.d.ts` 的脚本中使用 `type` 与 `interface`。

- 申明文件与对应脚本必须同名。
- 禁止多个脚本申明在同一申明文件。

## ESLint

- 需在 `vs code` 中安装 `eslint` 插件并严格遵守规则。
- 除规范规定情况外，禁止在文件中修改、关闭和禁止规则。

- 修改规则需提出并讨论后才能修改。

### 注释

- 难以理解的代码必须描述清楚，必要时附上参考文档等的链接

#### 函数

- 短的函数可无注释（<30行）。

- 中等长度至少要注明功能用途（30~150行）。
- 长函数必须根据内容写清注释（>150行）。
- 必须遵守命名规范。

#### 类

- 小类可无注释。
- 类方法同函数规范。
- 必须遵守命名规范。

#### 数学计算公式等

- 必须说明用途并简单解释公式。
- 有文档必须附上链接。

#### 其它

- 按功能用途写清。

---

## 组件

### 组件数量

- 一个文件组件仅一个组件和一个高级组件（可选）。

- 禁止子组件与父组件写入同一文件。

- 子组件可 `import` 进父组件并导出，但禁止修改。

#### 导入

- 禁止导入父辈组件。

### 导出

- 必须默认导出一个组件（或高级组件）。
- 可以导出其子组件。
- 可以导出 `Context`。
- 禁止导出其它东西。

### Props

- 参数必须命名为 `props` 或直接结构。

- 必须定义 props 类型， 类型以 `组件名+Props` 大驼峰命名。
- 禁止修改 Props。

### State

- 必须定义 state 类型， 类型以 `组件名+State` 大驼峰命名。
- 函数组件的state必须定义类型为 `FCState<T>` 。（`FCState<T>` 详见 `/interfaces/function-component-state.d.ts`

#### 例：

```tsx
// my-component.tsx

// 函数组件
export default MyComponent(props: MyComponentProps) { {
    const [value, setValue]: State<MyComponentState['value']> = useState(props.defaultValue);
    
    return <p>{value}</p>;
}
// 或
export default MyComponent({defaultValue}: MyComponentProps) {
    const [value, setValue]: State<MyComponentState['value']> = useState(defaultValue);
    
    return <p>{value}</p>;
}
                                                     

// 类组件
export default class MyComponent extends React.Component{
    props: Readonly<MyComponentProps>;
    state: Readonly<MyComponentState>;
    
    constructor(props: MyComponentProps) {
        super(props);
        // 可解构
        // const { defaultValue } = props;
        this.state = { value: defaultValue };
    }
    render() {
        const { value } = this.state;
        
        return <p>{value}</p>;
    }
}
                                   
/* -----------分割线----------- */

// my-component.d.ts

import {PropWithChildrens} from 'react';
                                                  
// 需要 children prop
export type MyComponentProps = PropsWithChildren<{
    //其它prop
    defaultValue: string;
}>;

// 不需要 children prop
export interface MyComponentProps {
    //其它prop
    defaultValue: string;
}

export interface MyComponentState {
    value: string;
} 
```

---

## 正常脚本

- 尽量做到低耦合，高内聚。
- 尽量运用设计模式。

---

# 命名规范

## 常量

- 必须以小驼峰命名或全大写。
- 必须以用途或常量内容命名。
- 除可缩写表中单词外，禁止缩写。
- 禁止单字母或无意义字母命名。
- 特殊情况：
    - for循环等中的临时变量允许使用单字母。

## 变量/参数

- 必须以小驼峰命名。
- 必须以用途或常量内容命名。
- 除可缩写表中单词外，禁止缩写。
- 禁止单字母或无意义字母命名。
- 必须定义的未使用变量/参数以 `_` 开头。
- 特殊情况：
    - for循环等中的临时变量允许单字母。
    - 以后要用到但还没使用的变量可以关闭 eslint 的 [prefer-const](https://eslint.org/docs/rules/prefer-const) 规则。

## 非匿名函数

- 必须以小驼峰命名。
- 必须以用途或常量内容命名。
- 除可缩写表中单词外，禁止缩写。
- 禁止单字母或无意义字母命名。

## 类

- 必须以大驼峰命名。
- 必须以用途或常量内容命名。
- 除可缩写表中单词外，禁止缩写。
- 禁止单字母或无意义字母命名。
- 命名禁止包含 `Base`。

## 可缩写表

注：首字母忽略大小写。

| 允许缩写 | 完整单词/词组 |
| -------- | ------------- |
| fn, fnc  | function      |
| val      | value         |
| html     | 略            |
| btn      | button        |
| arr      | array         |
| str      | string        |
| num      | number        |
| cvs      | canvas        |
| app      | application   |
| anime    | animation     |
| vec      | vector        |
| bpm      | 略            |
| img      | image         |
| pub      | public        |

## 组件

- 必须以大驼峰命名。
- 必须以用途或常量内容命名。
- 除可缩写表中单词外，禁止缩写。
- 禁止单字母或无意义字母命名。

## 接口

- 除已有规定的和与已有命名冲突的外，以 `I+接口名` 大驼峰命名。
- 必须以用途或常量内容命名。
- 除可缩写表中单词外，禁止缩写。
- 禁止单字母或无意义字母命名。